
# 鳥栖PO1期 可視化ツール（Streamlit）

**機能（本依頼の範囲）**
1. 基本プロット（kW・30分） — ロス前/ロス後を同一グラフに表示、期間指定可  
2. 集計（kWベース） — 日/月の平均・最大・最小  
4. オーバレイ（kW） — 指定日、月ごと同日、年ごと同月日を重ねて比較  
5. 単独表示（kW・範囲指定） — 30分 / 日平均 / 月平均、ロス前/ロス後の選択

**前提**  
- Excelは列名「開始日時」「使用電力量(ロス後)」「使用電力量(ロス前)」を含むこと  
- 30分間隔（0.5h）を前提とし、kWh → kW へは `kW = kWh / 0.5` として変換

## 使い方

### ローカル実行
```bash
pip install -r requirements.txt
streamlit run app.py
```

### データの準備
- サイドバーの*Excelアップロード*からファイルを読み込みます（シート名未指定時は先頭を使用）。
- 自動で kW 列（「使用電力量(ロス後)_kW」「使用電力量(ロス前)_kW」）を作成します。

### タブの説明
- **1) 基本プロット**: 30分データを kW でプロット。期間と系列（both/ロス前/ロス後）を選択。  
- **2) 集計**: kWベースで日/月の *mean/max/min* を選んで集計。  
- **4) オーバレイ**: 指定日、月ごと同一日、年ごと同一月日で日曲線（0..47スロット）を重ねて比較。  
- **5) 単独表示**: 非オーバレイ。横軸範囲と粒度（30分/日/月）、系列を選択。  

### 備考
- 日本語フォントは `Noto Sans CJK JP` を試行します（Streamlit環境で未インストールの場合は自動フォールバック）。
- すべてのグラフは Matplotlib を使用しています。

## デプロイ（GitHub + Streamlit Cloud）
1. GitHub にこのリポジトリをプッシュ
2. Streamlit Cloud でNew app → リポジトリ/ブランチ選択、`app.py` をエントリーポイントに指定
3. デプロイ完了後、Web UI 上からExcelをアップロードして利用可能
